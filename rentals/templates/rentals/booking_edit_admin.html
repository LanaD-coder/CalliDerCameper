{% extends "base.html" %}

{% block content %}
<section id="booking_admin_section" class="form-section">
  <h2>Buchung bearbeiten</h2>

  <div class="booking-info">
    <p><strong>Buchungsnummer:</strong> {{ booking.booking_number }}</p>
    <p><strong>Campervan:</strong> {{ booking.campervan.name }}</p>
    <p><strong>Startdatum:</strong> {{ booking.start_date }}</p>
    <p><strong>Enddatum:</strong> {{ booking.end_date }}</p>
    <p><strong>Gesamtpreis:</strong> ‚Ç¨{{ booking.total_price }}</p>
    <p><strong>Status:</strong> {{ booking.status }}</p>
    <p><strong>Zahlungsstatus:</strong> {{ booking.payment_status }}</p>
  </div>

  <hr>

  <h3>Details Hauptfahrer</h3>
  <p><strong>Name:</strong> {{ booking.primary_driver_name }}</p>
  <p><strong>Stra√üe:</strong> {{ booking.primary_driver_street_name }} {{ booking.primary_driver_street_number }}</p>
  <p><strong>PLZ:</strong> {{ booking.primary_driver_postal_code }}</p>
  <p><strong>Ort:</strong> {{ booking.primary_driver_town }}</p>
  <p><strong>Land:</strong> {{ booking.primary_driver_country }}</p>

  {% if booking.additional_driver_name %}
    <hr>
    <h3>Details Zusatzfahrer</h3>
    <p><strong>Name:</strong> {{ booking.additional_driver_name }}</p>
    <p><strong>E-Mail:</strong> {{ booking.additional_driver_email }}</p>
    <p><strong>Telefonnummer:</strong> {{ booking.additional_driver_contact_number }}</p>
    <p><strong>Stra√üe:</strong> {{ booking.additional_driver_street }}</p>
    <p><strong>PLZ:</strong> {{ booking.additional_driver_postal_code }}</p>
    <p><strong>Ort:</strong> {{ booking.additional_driver_town }}</p>
    <p><strong>Land:</strong> {{ booking.additional_driver_country }}</p>
  {% endif %}

  <hr>

  <h3>Zusatzleistungen</h3>
  {% if booking.additional_services.all %}
    <ul>
      {% for service in booking.additional_services.all %}
        <li>{{ service.name }}</li>
      {% endfor %}
    </ul>
  {% else %}
    <p>Keine Zusatzleistungen ausgew√§hlt.</p>
  {% endif %}

  <hr>

  <h3>Checklisten</h3>

  <p>
    √úbergabe-Checkliste:
    {% if handover_checklist %}
        ‚úÖ <a href="{% url 'checklist_detail' handover_checklist.pk %}">Ansehen</a> |
        <a href="{% url 'checklist_pdf' handover_checklist.pk %}" target="_blank">PDF herunterladen</a>
    {% else %}
        ‚ùå <a href="{% url 'handover_checklist' booking.booking_number %}">Erstellen</a>
    {% endif %}
  </p>

  <p>
      R√ºckgabe-Checkliste:
      {% if return_checklist %}
          ‚úÖ <a href="{% url 'checklist_detail' return_checklist.pk %}">Ansehen</a> |
          <a href="{% url 'checklist_pdf' return_checklist.pk %}" target="_blank">PDF herunterladen</a>
      {% else %}
          ‚ùå <a href="{% url 'return_checklist' booking.booking_number %}">Erstellen</a>
      {% endif %}
  </p>
  <hr>

  <form method="POST" action="{% url 'booking_edit' booking.pk %}">
    {% csrf_token %}
    {{ form.as_p }}
    <button type="submit" id="save-btn">√Ñnderungen speichern</button>
  </form>
  <hr>
  <button onclick="window.print()" class="btn" id="print-btn">üñ®Ô∏è Buchung drucken</button>
</section>
{% endblock %}
